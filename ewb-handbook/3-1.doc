part 3
chapter 1
//I 応用編
//i 図表ファイルの作成

  EWBのトリガでは、簡単な表やリストの要素を作成する機能しかありません。この機能だけでは図版を含んだページアップをするのに少々力不足です。そこでEWBでは、表プロセッサなどの図表作成ツールを使って電子化された図表ファイルを取り込んで処理する仕掛けを用意しています。さらに、EWBは組版エンジンとして//TeXを利用しているため、//TeXファイルの図表類であれば原稿中に取り込むことができます。
ここでは、EWBで扱えるこれらの図表要素をうまく出力するためのノウハウを説明していきます。

//ii EWBで扱える図表

EWBで扱える図表の種類を、各要素ごとに見ていきましょう。

//iii //in267図の扱い

  図には、フローチャートのようなものから、イラストレータやデザイナーが作成する凝った絵までいろいろな種類があります。EWBではこれらの図をEPS形式のファイルにすることですべて扱うことができます。

//iii //in268表の扱い

  EWBには、“////table”を使って表を作成する機能があります。この表組トリガはタブを使って表を表現するため、格子状の表しか作成できません。複雑な表を作成するのであれば、Illustrator等の画像作成ツールで作成し、EPS画像として扱ったほうが効率が良いでしょう。

//iii //in266リストの扱い

  プログラムリストは、EWBがもっとも得意とする要素です。コンスタントピッチの書体を使い、タブやスペースによる桁揃えを認識します。さらに、書体や字送りなどの体裁を変更したコメントを埋め込むこともできます。

//iii //in265数式の扱い

  EWBシステムの組版エンジンである//TeXは、もともと数式をきれいに作成するために開発されたものです。ところが、//TeXを利用しているにもかかわらず、EWBには数式を記述する方法が、現時点では備わっていません。このため、数式を組み込むためには、数式を直接//TeX形式でコーディングして対処することになります。

//ii 図表ファイルと本文とのリンク

  次に図表類と本文の関係を見てみましょう。図表類は大きく分けると、

//k1{
・原稿中に埋め込まれた図表
・原稿とは別になっている図表ファイル
//}

の2つになります。
  本文原稿中に埋め込まれた表やリストなどは、図表というよりはむしろ本文と同様の扱いを受けます。そのため、これらの図表類はフロートすることはなく、本文原稿中で入力された位置に必ず出力されます。また、原稿中に埋め込まれた図表には、番号やキャプションを付けることはできません。もし、キャプションの付いた図表として扱いたい場合には、図表部分を本文から切り出して別の外部ファイルにする必要があります。

//iii //in269外部ファイルにした図表

  EWBで扱える図表ファイルの種類は、次のようになっています。

//table{
//bkei
//g{拡張子//}	//g{説明//}
//tkei
.tbl	EWBコーディングした表
.lst	EWBコーディングしたリスト
.tex	//TeXコーディングした数式など
.eps	EPS形式の画像
//bkei
//}
  
  EWBは、拡張子によってファイルの種別を判断します。これらの拡張子以外を指定した場合は、すべてEWBコーディングしたファイルであると判断します。
  また、これらの図表ファイルを本文中に読み込むには、物理属性ファイルを介して読み込む方法とインクルードトリガ“////inc”を使う2つの方法があります。物理属性ファイルを介して取り込む場合は、図表トリガの後に入力した文字列がキャプションとして出力され、インクルードトリガを使って本文に取り込む場合には、キャプションが付きません。EPSファイルだけは////incで読みこむことはできません。

//iii //in270EPSファイルの扱い

  EWBではEPSファイルを取り込むことができます。これにより、イラスト的な図や複雑な線画も扱うことができるわけです。ただし、扱えるEPSファイルには以下のような制限があります。

//k1{
・//in271ASCII形式（テキスト形式）であること
・改行コードがUNIX形式であること
・ヘッダ部に漢字が使用されている場合、漢字コードがEUCであること
//}

  //in272Macintoshで作成したEPSファイルの場合、UNIXに転送したときに改行コードがMacintosh形式のままである場合があります。これらのコードチェックをするには//g{//in273epscheck//}というコマンドを使用します。

//list2{
% epscheck EPSファイル名
//}

  ファイルが適切でない場合、次のようなエラーメッセージを出力します。

//list2{
% //sl{epscheck test.eps//}
test.eps : warning:バイナリ形式になっています
test.eps : warning:改行コードがUNIX用ではありません
test.eps : warning:漢字コードが違います
%
//}

  改行コードがUNIX形式になっていない場合は以下のコマンドで改行コードを変換してください。

//list2{
% tounix ファイル名
//}

  ファイルが//in274バイナリ形式であった場合はUNIX上でASCII形式に直すことはできません。MacinctoshなどでASCII形式で保存しなおしてください。

//iii //in275インクルードトリガで取り込む

  作成した図版を本文に取り込むには、編集トリガの“//////in276inc”を使います。本来、別ファイルになった図表をEWBの本文に中に取り込むには、ファイルの種類ごとに適切な処理を必要とします。“////inc”は、その処理を自動的に図表ファイルに対して行ってくれるため、何もする必要がありません。ただし、EPSファイルだけは“////inc”では扱えません。

//iii インクルードトリガの入力方法

  図表を取り込むには、インクルードトリガの後に“ファイル名”を入力します。

//list2{
□□□□□□□□□□□□□□□□□□□□□□□□□
////inc //cmt{[図表ファイル名].[拡張子]//}
□□□□□□□□□□□□□□□□□□□□□□□□□
//}

  たとえば、“list1.lst”というリストファイルを本文に取り込むには、次のような指定を行います。

//list2{
□□□□□□□□□□□□□□□□□□□□□□□□□
////inc list1.lst
□□□□□□□□□□□□□□□□□□□□□□□□□
//}

  なお、“////inc”は段落と段落の間にしか指定できません。そのため、たとえば数式を段落の途中に貼り込むのに、

//list2{
……□□□□□因数分解の////inc equ1.texという公式は□□□□□、……
//}

のような使い方はできません。もし、このような表現をしたい場合には、組み込みトリガ“//////in277LaTeX”を使用して、

//list2{
……□□□□□因数分解の////LaTeX{ $(\alpha + \beta)^2 = \alpha^2 + 2\alpha
\beta + \beta^2$ ////LaTeX}という公式は□□□□□、……
//}

のように直接書き込みます。すると
 　 
……□□□□□因数分解の//LaTeX{ $(\alpha + \beta)^2 = \alpha^2 + 2\alpha\beta + \beta^2$ //LaTeX}という公式は□□□□□、……

という出力が得られます。
  EPSファイルは段落の間でも途中でも“////inc”トリガでは扱うことはできません。EPSファイルを直接取り込むには、“////ZUHAN”トリガまたは“////ICON”トリガを使用して、

//list2{
  □□□□□□□□□□□□□□□□□□□□□□□□□□□□□
□□□////ICON{0mm,0mm,50,icon.eps////}□□□□□□□□□□□□
               //cmt{……文中の場合//}

  □□□□□□□□□□□□□□□□□□□□□□□□□□□□□
□□□□□□□□□□□□□□□□□□□
////ZUHAN{100mm,0mm,0,c,zuhan.eps////}
               //cmt{……行間の場合//}
  □□□□□□□□□□□□□□□□□□□□□□□□□□□□□
□□□□□□□□□□□□□□□□□□□□□□□
//}

のように書きます。////ZUHAN, ////ICONトリガについては//g{Appendix //numref{hyoujuntriger//} //strref{hyoujuntriger//}//}（//pageref{hyoujuntriger//}ページ）を参照してください。
